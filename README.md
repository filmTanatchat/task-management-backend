# Task Management Backend API

This is a complete backend REST API for a Task Management System, built with Node.js, Express, and MongoDB. It includes secure authentication with JWT, role-based access control (Admin and User), full CRUD operations for tasks, and user management.

## Features

- User registration and login with JWT-based authentication
- Role-based access control (Admin, User)
- Task CRUD operations (Create, Read, Update, Delete)
- Middleware for logging, error handling, and security headers
- MongoDB for data storage
- HTTP error code handling for 400, 401, 403, 404, 500

## Technologies Used

- Node.js
- Express.js
- MongoDB with Mongoose
- bcryptjs
- jsonwebtoken
- helmet
- morgan

## Setup Instructions

### 1. Clone the Repository

```bash
git clone https://github.com/your-username/task-management-backend.git
cd task-management-backend
```

### 2. Install Dependencies

```bash
npm install
```

### 3. Set Up Environment Variables

Create a `.env` file in the root folder and add the following:

```
PORT=5000
MONGO_URI=mongodb://localhost:27017/taskdb
JWT_SECRET=your_super_secret_jwt_key
```

Use a secure, randomly generated `JWT_SECRET`, such as one generated by:
`openssl rand -hex 64`

### 4. Start the Server

For development (with live reloading using nodemon):

```bash
npm run dev
```

For production:

```bash
npm start
```

## How to Use

### Authentication

Use the `/auth/signup` endpoint to register a user and `/auth/login` to authenticate. Both return a JWT token. This token must be included in the `Authorization` header as a Bearer token for protected routes.

Example:

```
Authorization: Bearer <your_token_here>
```

## API Endpoints

### Auth Routes

#### POST /auth/signup
Registers a new user.

**Request Body:**
```json
{
  "name": "John Doe",
  "email": "john@example.com",
  "password": "password123",
  "role": "user"
}
```

**Response:**
```json
{
  "token": "JWT_TOKEN_HERE"
}
```

#### POST /auth/login
Logs in a user and returns a JWT token.

**Request Body:**
```json
{
  "email": "john@example.com",
  "password": "password123"
}
```

**Response:**
```json
{
  "token": "JWT_TOKEN_HERE"
}
```

### User Routes

#### GET /users
Returns all users.
Access: Admin only.

**Headers:**
```
Authorization: Bearer <token>
```

**Response:**
```json
[
  {
    "_id": "user_id",
    "name": "John Doe",
    "email": "john@example.com",
    "role": "user"
  }
]
```

#### GET /users/:id
Returns a user's profile.
Access: Authenticated users.

**Response:**
```json
{
  "_id": "user_id",
  "name": "John Doe",
  "email": "john@example.com",
  "role": "user"
}
```

### Task Routes

#### POST /tasks
Create a new task.
Access: Authenticated users.

**Request Body:**
```json
{
  "title": "Finish report",
  "description": "Write and submit Q1 report",
  "status": "pending",
  "dueDate": "2024-12-31T00:00:00.000Z"
}
```

**Response:**
```json
{
  "_id": "task_id",
  "title": "Finish report",
  "description": "Write and submit Q1 report",
  "status": "pending",
  "assignedTo": "user_id",
  "dueDate": "2024-12-31T00:00:00.000Z"
}
```

#### GET /tasks
Get all tasks assigned to the authenticated user.
Access: Authenticated users.

**Response:**
```json
[
  {
    "_id": "task_id",
    "title": "Finish report",
    "description": "Write and submit Q1 report",
    "status": "pending",
    "assignedTo": "user_id",
    "dueDate": "2024-12-31T00:00:00.000Z"
  }
]
```

#### GET /tasks/:id
Get a specific task by ID.
Access: Task owner or Admin.

**Response:**
```json
{
  "_id": "task_id",
  "title": "Finish report",
  "description": "Write and submit Q1 report",
  "status": "pending",
  "assignedTo": "user_id",
  "dueDate": "2024-12-31T00:00:00.000Z"
}
```

#### PUT /tasks/:id
Update a task.
Access: Task owner or Admin.

**Request Body:**
```json
{
  "status": "completed"
}
```

**Response:**
```json
{
  "_id": "task_id",
  "title": "Finish report",
  "description": "Write and submit Q1 report",
  "status": "completed",
  "assignedTo": "user_id",
  "dueDate": "2024-12-31T00:00:00.000Z"
}
```

#### DELETE /tasks/:id
Delete a task.
Access: Task owner or Admin.

**Response:**
```json
{
  "message": "Task deleted"
}
```

## Error Handling

All endpoints return appropriate status codes and error messages:

| Code | Meaning               |
|------|------------------------|
| 400  | Bad Request            |
| 401  | Unauthorized           |
| 403  | Forbidden              |
| 404  | Not Found              |
| 500  | Internal Server Error  |

## Roles & Permissions

| Role  | Permissions                                    |
|-------|------------------------------------------------|
| User  | Create, view, update (own), delete (own) tasks |
| Admin | Full access to all tasks and all users         |

## License

This project is open-source and free to use under the MIT License.